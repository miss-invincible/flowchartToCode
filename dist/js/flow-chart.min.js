var sweet="",code=[],indent=0,flow=function(e,t,n){"use strict";e.Util={};var o=e.Util,a=new Mottle;return o.count=1,o.getUniqueID=function(e){return e=e.replace(/\s/g,""),e+"-"+o.count++},o.isEmptyObject=function(e){return 0===Object.keys(e).length},o.triggerEvent=function(e,t){var n=new Event(e,{view:window,bubbles:!0,cancelable:!0});return t.dispatchEvent(n)},o.trigger=function(e,t,n){return a.trigger(t,e,void 0,n),this},o.on=function(){return 3===arguments.length?a.on(arguments[0],arguments[1],arguments[2]):4===arguments.length?this.elementAddDelegatedEvent(arguments[0],arguments[1],arguments[2],arguments[3]):console.log("called On method with wrong number of arguments"),this},o.extend=function(e,t){return n.extend(e,t)},o.elementAddDelegatedEvent=function(e,t,n,o){var a=this;e.addEventListener(t,function(t){for(var l=t.target,i=!0;!a.elementMatches(l,n);){if(!l||l.isEqualNode(e)){i=!1;break}l=l.parentNode}i&&o.call(l,t)},!1)},o.remove=function(e){return a.remove(e),this},o.isFunction=function(e){return n.isFunction(e)},o.invokeAllFunctions=function(e){Object.getOwnPropertyNames(e).forEach(function(t){"function"==typeof e[t]&&e[t]()})},o.elementMatches=function(e,n){var o=t.body.matchesSelector||t.body.webkitMatchesSelector||t.body.mozMatchesSelector||t.body.msMatchesSelector||t.body.webkitMatchesSelector||t.body.matchesSelector;return e&&o.call(e,n)},o.isNumber=function(e){return!window.isNaN(e)},o.clone=function(e){return n.clone(e)},e}(flow||{},document,jsPlumbUtil),flow=function(e,t){"use strict";e.State={};var n=e.State,o=[],a=[];n.cleanState=function(){o=[],a=[]},n.cleanRedoState=function(){a=[]},n.pushShapeAlteration=function(t,n){var a=e.getShapeData(t);a.isNew="created"===n,o.push(a)},n.undo=function(){var t=o.pop();if(void 0!==t){var n=e.findShapeById(t.id),i=null;n?i=e.getShapeData(n):(i=e.Util.clone(t),i.isNew=!0),a.push(i),l(t)}},n.redo=function(){var e=a.pop();void 0!==e&&l(e)};var l=function(t){var n=e.findShapeById(t.id),o=null;t.isNew===!0?(o=n.parentNode,i(n),o.focus()):null!==n?(s(n,t),c(n,t.sourceConnections,t.targetConnections)):(n=r(t),c(n,t.sourceConnections,t.targetConnections))},i=function(n){n.classList.contains("selected")&&e.Selection.unselectShapes(),t.detachAllConnections(n),e.Util.remove(n)},s=function(e,n){u(e,n),t.repaint(e)},r=function(t){var n=e.getShapeCloneByType(t.type),o=e.getCurrentDiagram();return o.appendChild(n),u(n,t),e.makeShapeDraggable(n,t),n},c=function(e,n,o){for(var a=e.parentNode,l=t.getConnections({source:e}),i=l.length;i--;){var s=l[i],r=s.source.getAttribute("data-flow-id");r in n||t.detach(s)}for(var c in n){var u=n[c].label,d=a.querySelector('div.shape[data-flow-shape-id="'+c+'"]'),p=t.getConnections({source:d,target:e}).length>0;p||t.connect({source:d,target:e,label:u})}for(var c in o){var u=o[c].label,g=a.querySelector('div.shape[data-flow-shape-id="'+c+'"]');p=t.getConnections({source:e,target:g}).length>0,p||t.connect({source:e,target:g,label:u})}},u=function(e,t){if(t.width||t.height){var n=e.querySelector(".shape.image");n.style.width=t.width,n.style.height=t.height}t.code&&(e.querySelector("code").textContent=t.code),e.style.top=t.top,e.style.left=t.left,e.setAttribute("data-flow-shape-id",t.id),e.focus()};return e}(flow||{},jsPlumb),flow=function(e,t){"use strict";return e.Cache={setCache:function(){var n=e.Cache;n.shapeMenu=t.getElementById("shape-menu"),n.diagramContainer=t.getElementById("right-area"),n.toolbarContainer=t.getElementById("toolbar-container"),n.tabMenuList=n.diagramContainer.querySelector(".flow.tab.list"),n.consoleArea=t.getElementById("console-area"),n.editor2=document.querySelector(".editor2"),n.fuck=document.querySelector(".fuck"),n.consoleToggle=n.consoleArea.querySelector(".console.toggle.button"),n.consoleExecute=n.consoleArea.querySelector(".console.execution.buttons .execute"),n.consoleDebugStart=n.consoleArea.querySelector(".console.execution.buttons .debug.start"),n.consoleDebugStop=n.consoleArea.querySelector(".console.execution.buttons .debug.stop"),n.consoleDebugNext=n.consoleArea.querySelector(".console.execution.buttons .debug.next"),n.consoleExhibition=n.consoleArea.querySelector(".console.exhibition"),n.consoleExhibitionClean=n.consoleArea.querySelector(".clean"),n.consoleExhibitionContent=n.consoleExhibition.querySelector(".content"),n.code=n.consoleArea.querySelector(".code_python"),n.code=n.editor2.querySelector(".ace_editor")}},e}(flow||{},document),flow=function(e,t){"use strict";e.Alerts={};var n=e.Alerts,o=null,a=null;n.showInfoMessage=function(e){l(e,"info")},n.showWarningMessage=function(e){l(e,"warning")},n.showErrorMessage=function(e){l(e,"error")},n.showSuccessMessage=function(e){l(e,"success")},n.confirm=function(e){return window.confirm(e)};var l=function(e,n){var l=[0,.8,.82,.84,.86,.88,.9];window.clearInterval(a),(null===o||null===o.parentNode)&&(o=t.getElementById("alert-messages")),o.setAttribute("data-flow-message-type",n),o.innerHTML="<span>"+e+"</span>",o.style.opacity=1,a=setInterval(function(){o.style.opacity>0?o.style.opacity=l.pop():window.clearTimeout(a)},500)};return e}(flow||{},document),flow=function(e,t){e.setDefaults=function(){o(),n(),a()};var n=function(){var t=e.Cache.diagramContainer.style,n=window.getComputedStyle(e.Cache.diagramContainer.querySelector(".flow.tab.menu")).getPropertyValue("height"),o=window.innerHeight;t.height=o-parseInt(n,10)+"px",window.onresize=function(e){o=window.innerHeight,t.height=o-parseInt(n,10)+"px"};var a=e.Cache.shapeMenu,l=a.querySelector("div.shape.display .shape.image"),i=document.createElement("img"),s=a.querySelector("div.shape.manual_input .shape.image"),r=document.createElement("img");i.src="../src/img/display.gif",i.className="shape image",l.parentNode.replaceChild(i,l),r.src="../src/img/manual_input.png",r.className="shape image",s.parentNode.replaceChild(r,s)},o=function(){var e=t.Defaults,n={fillStyle:"transparent"};e.EndpointStyles=[n,n],e.Endpoints=[["Rectangle",{cssClass:"source-anchor",radius:15}],["Rectangle",{radius:15}]],e.Anchor="Continuous",e.Connector="Flowchart",e.PaintStyle={gradient:{stops:[[0,"midnightblue"],[1,"black"]]},strokeStyle:"brown",lineWidth:2},t.Defaults.ConnectionOverlays=[["Arrow",{width:25,length:25,location:1}]],e.ReattachConnections=!0},a=function(){var t=JSON.stringify({diagrams:{"Newdiagram-1-1-1-4-4-4-1-1-2-3-2-1-1-1-1-1-1-1":{id:"Newdiagram-1-1-1-4-4-4-1-1-2-3-2-1-1-1-1-1-1-1-1",name:"Example 3: decision",shapes:[{id:"process-8",type:"process",top:"57px",left:"186px",code:"x = 10",sourceConnections:{"begin-2":{label:null}},targetConnections:{"decision-3":{label:null}},width:null,height:null},{id:"end-7",type:"end",top:"227px",left:"1087px",code:"",sourceConnections:{"connector-6":{label:null}},targetConnections:{},width:null,height:null},{id:"connector-6",type:"connector",top:"318px",left:"816px",code:"",sourceConnections:{"display-5":{label:null},"display-4":{label:null}},targetConnections:{"end-7":{label:null}},width:null,height:null},{id:"display-5",type:"display",top:"337px",left:"400px",code:'"not"',sourceConnections:{"decision-3":{label:"<p id='jsPlumb_1_9_jsPlumb_1_11' class='connection label overlay' style='top:;left:;' >false</p>"}},targetConnections:{"connector-6":{label:null}},width:null,height:null},{id:"display-4",type:"display",top:"66px",left:"791px",code:'"x is 10"',sourceConnections:{"decision-3":{label:"<p id='jsPlumb_1_9_jsPlumb_1_10' class='connection label overlay' style='top:;left:;' >true</p>"}},targetConnections:{"connector-6":{label:null}},width:null,height:null},{id:"decision-3",type:"decision",top:"104px",left:"467px",code:"x == 10",sourceConnections:{"process-8":{label:null}},targetConnections:{"display-5":{label:"<p id='jsPlumb_1_9_jsPlumb_1_11' class='connection label overlay' style='top:;left:;' >false</p>"},"display-4":{label:"<p id='jsPlumb_1_9_jsPlumb_1_10' class='connection label overlay' style='top:;left:;' >true</p>"}},width:null,height:null},{id:"begin-2",type:"begin",top:"225px",left:"69px",code:"",sourceConnections:{},targetConnections:{"process-8":{label:null}},width:null,height:null}]},"Newdiagram-36-4-3-2-2":{id:"Newdiagram-36-4-3-2-2-2",name:"Example 4: While",shapes:[{id:"process-42",type:"process",top:"846px",left:"1560px",code:"i <- i - 1",sourceConnections:{"display-40":{label:null}},targetConnections:{"decision-39":{label:null}},width:null,height:null},{id:"end-41",type:"end",top:"577px",left:"2165px",code:"",sourceConnections:{"decision-39":{label:"<p id='jsPlumb_1_200_jsPlumb_1_202' class='connection label overlay' style='top:; left:;' >false</p>"}},targetConnections:{},width:null,height:null},{id:"display-40",type:"display",top:"846px",left:"1848px",code:"i",sourceConnections:{"decision-39":{label:"<p id='jsPlumb_1_200_jsPlumb_1_201' class='connection label overlay' style='top:; left:;' >true</p>"}},targetConnections:{"process-42":{label:null}},width:null,height:null},{id:"decision-39",type:"decision",top:"579px",left:"1708px",code:"i > 0",sourceConnections:{"process-42":{label:null},"process-38":{label:null}},targetConnections:{"end-41":{label:"<p id='jsPlumb_1_200_jsPlumb_1_202' class='connection label overlay' style='top:; left:;' >false</p>"},"display-40":{label:"<p id='jsPlumb_1_200_jsPlumb_1_201' class='connection label overlay' style='top:; left:;' >true</p>"}},width:null,height:null},{id:"process-38",type:"process",top:"576px",left:"1465px",code:"i <- 5",sourceConnections:{"begin-37":{label:null}},targetConnections:{"decision-39":{label:null}},width:null,height:null},{id:"begin-37",type:"begin",top:"572px",left:"1255px",code:"",sourceConnections:{},targetConnections:{"process-38":{label:null}},width:null,height:null}]},"Newdiagram-43-4-3-3":{id:"Newdiagram-43-4-3-3-3",name:"Example 5: Do While",shapes:[{id:"end-49",type:"end",top:"811px",left:"1345px",code:"",sourceConnections:{"decision-48":{label:"<p id='jsPlumb_1_981_jsPlumb_1_1712' class='connection label overlay' style='top:; left:;' >false</p>"}},targetConnections:{},width:null,height:null},{id:"decision-48",type:"decision",top:"823px",left:"1832px",code:"i > 0",sourceConnections:{"process-47":{label:"<p id='jsPlumb_1_878_jsPlumb_1_981' class='connection label overlay' style='top:; left:;' ></p>"}},targetConnections:{"display-46":{label:"<p id='jsPlumb_1_981_jsPlumb_1_868' class='connection label overlay' style='top:; left:;' >true</p>"},"end-49":{label:"<p id='jsPlumb_1_981_jsPlumb_1_1712' class='connection label overlay' style='top:; left:;' >false</p>"}},width:null,height:null},{id:"process-47",type:"process",top:"597px",left:"2211px",code:"i <- i - 1",sourceConnections:{"display-46":{label:null}},targetConnections:{"decision-48":{label:"<p id='jsPlumb_1_878_jsPlumb_1_981' class='connection label overlay' style='top:; left:;' ></p>"}},width:null,height:null},{id:"display-46",type:"display",top:"566px",left:"1809px",code:"i",sourceConnections:{"decision-48":{label:"<p id='jsPlumb_1_981_jsPlumb_1_868' class='connection label overlay' style='top:; left:;' >true</p>"},"process-45":{label:null}},targetConnections:{"process-47":{label:null}},width:null,height:null},{id:"process-45",type:"process",top:"557px",left:"1498px",code:"i <- 5",sourceConnections:{"begin-44":{label:null}},targetConnections:{"display-46":{label:null}},width:null,height:null},{id:"begin-44",type:"begin",top:"566px",left:"1281px",code:"",sourceConnections:{},targetConnections:{"process-45":{label:null}},width:null,height:null}]},"Newdiagram-27-2-3-2-2-2-2-2-5-4":{id:"Newdiagram-27-2-3-2-2-2-2-2-5-4-4",name:"Example 2: User input",shapes:[{id:"end-31",type:"end",top:"684px",left:"1914px",code:"",sourceConnections:{"display-30":{label:null}},targetConnections:{},width:null,height:null},{id:"display-30",type:"display",top:"695px",left:"1701px",code:"someVar",sourceConnections:{"manual_input-29":{label:null}},targetConnections:{"end-31":{label:null}},width:null,height:null},{id:"manual_input-29",type:"manual_input",top:"680px",left:"1419px",code:"someVar",sourceConnections:{"begin-28":{label:null}},targetConnections:{"display-30":{label:null}},width:null,height:null},{id:"begin-28",type:"begin",top:"542px",left:"1293px",code:"",sourceConnections:{},targetConnections:{"manual_input-29":{label:null}},width:null,height:null}]},"Newdiagram-20-2-1-1-1-3-3-5-4-5":{id:"Newdiagram-20-2-1-1-1-3-3-5-4-5-5",name:"Example 1: Hello World",shapes:[{id:"end-26",type:"end",top:"714px",left:"1860px",code:"",sourceConnections:{"display-25":{label:null}},targetConnections:{},width:null,height:null},{id:"display-25",type:"display",top:"756px",left:"1467px",code:'x + "World"',sourceConnections:{"process-24":{label:null}},targetConnections:{"end-26":{label:null}},width:null,height:null},{id:"process-24",type:"process",top:"597px",left:"1439px",code:'x <- "Hello "',sourceConnections:{"begin-23":{label:null}},targetConnections:{"display-25":{label:null}},width:"126px",height:"48px"},{id:"begin-23",type:"begin",top:"543px",left:"1189px",code:"",sourceConnections:{},targetConnections:{"process-24":{label:null}},width:null,height:null}]}},data:{count:53}});null===localStorage.getItem("flow")&&localStorage.setItem("flow",t),e.examples=t};return e}(flow||{},jsPlumb),flow=function(e,t,n){"use strict";var o={diagrams:{},data:{}};return e.getShapeData=function(e){for(var t=n.getConnections({target:e}),o=n.getConnections({source:e}),a={},l={},i=e.querySelector(".shape.image"),s=e.querySelector("code"),r="",c=t.length;c--;){var u=t[c],d=u.source.getAttribute("data-flow-shape-id");a[d]={label:u.getLabel()}}for(var c=o.length;c--;){var u=o[c],p=u.suspendedElement||u.target,d=p.getAttribute("data-flow-shape-id");l[d]={label:u.getLabel()}}return r=null!==s?s.textContent:e.querySelector("input").value,{id:e.getAttribute("data-flow-shape-id"),type:e.getAttribute("data-flow-shape-type"),top:e.style.top,left:e.style.left,code:r,sourceConnections:a,targetConnections:l,width:i.style.width||null,height:i.style.height||null}},e.getDiagramData=function(t){for(var n=[],o=t.querySelectorAll("div.flow.shape"),a=o.length;a--;){var l=e.getShapeData(o[a]);n.push(l)}return{id:t.id,name:t.getAttribute("data-flow-name"),shapes:n}},e.storeDiagramData=function(e){o.diagrams[e.id]={id:e.id,name:e.name,shapes:e.shapes}},e.getStoredDiagramData=function(e){if(e in o.diagrams)return o.diagrams[e];throw"Diagram "+e+" data not found"},e.getStoredDataFromAllDiagrams=function(){var t=e.getCurrentDiagram();return null!==t&&(o.diagrams[t.id]=e.getDiagramData(t)),o.data.count=e.Util.count,o},e.cleanStoredDiagramData=function(e){if(!(e in o.diagrams))throw"Diagram "+e+" data not found";delete o.diagrams[e]},e.cleanAllDiagramsStoredData=function(){o={diagrams:{},data:{}}},e}(flow||{},document,jsPlumb),flow=function(e,t,n){"use strict";e.Listeners={};var o=e.Listeners,a=(e.Cache,e.Util);o.setupDiagramEvents=function(e){l(e)};var l=function(e){a.on(e,"mouseover",function(e){var t=e.target;t instanceof SVGElement||-1===t.className.indexOf("resize anchor")||n.setDraggable(t.parentNode,!1)}),a.on(e,"mouseout",function(e){var t=e.target;t instanceof SVGElement||-1===t.className.indexOf("resize anchor")||n.setDraggable(t.parentNode,!0)}),i(e)},i=function(e){var t,o,l,i=!1;e.addEventListener("mousedown",function(n){var o=n.target;o instanceof SVGElement||-1===o.className.indexOf("resize anchor")||(t=o,e.addEventListener("mousemove",s))});var s=function(e){var a=e.screenX,s=e.screenY;if(i===!0){var r,c=t.parentNode,u=t.parentNode.querySelector(".shape.image"),d=parseInt(c.style.left,10),p=parseInt(c.style.top,10);u.style.width||(u.style.width=window.getComputedStyle(u).getPropertyValue("width")),u.style.height||(u.style.height=window.getComputedStyle(u).getPropertyValue("height"));var g=parseInt(u.style.width,10),h=parseInt(u.style.height,10),f=t.classList;o>a?(r=o-a,f.contains("left")?(c.style.left=d-r+"px",u.style.width=g+r+"px"):u.style.width=g-r+"px"):a>o&&(r=a-o,f.contains("left")?(c.style.left=d+r+"px",u.style.width=g-r+"px"):u.style.width=g+r+"px"),s>l?(r=s-l,f.contains("bottom")?u.style.height=h+r+"px":(c.style.top=p+r+"px",u.style.height=h-r+"px")):l>s&&(r=l-s,f.contains("bottom")?u.style.height=h-r+"px":(c.style.top=p-r+"px",u.style.height=h+r+"px")),n.repaint(t.parentNode)}i=!0,o=a,l=s};a.on(e,"mouseup",function(e){this.removeEventListener("mousemove",s,!1),i=!1})};return e}(flow||{},document,jsPlumb),flow=function(e,t,n){"use strict";e.StaticListeners={};var o=e.StaticListeners,a=e.Cache,l=e.Util;return o._createDiagramClick=function(){l.on(a.toolbarContainer,"click","#create-new-flowchart",function(t){t.preventDefault();var n="New diagram";e.createDiagram(n),e.appendTabItemToDiagramArea(n)})},o._openDiagramsClick=function(){var n=t.getElementById("temp-upload");l.on(a.toolbarContainer,"click","ul.flow.toolbar.list.open.diagram li a",function(t){t.preventDefault();var n=e.Alerts.confirm("This will close all your diagrams WITHOUT saving. Want to proceed?");n&&o.call(this)}),n.addEventListener("change",function(t){var o=n.files[0],a=new FileReader;a.onload=function(){var t=a.result;e.openDiagrams(t)},a.readAsText(o)},!1);var o=function(){e.closeAllDiagrams();var t=this.getAttribute("href");switch(t){case"json-file":l.trigger("click",n);break;case"local-storage":var o=e.openLocallyStoredDiagrams();o||e.Alerts.showErrorMessage("No diagrams found in the browser");break;case"examples":e.openDiagrams(e.examples),e.Alerts.showSuccessMessage("Examples open");break;default:var a="Open "+t+" option doesn't exist";throw e.Alerts.showErrorMessage(a),a}}},o._saveDiagramsClick=function(){var t="ul.flow.toolbar.list.save.diagram li a:not(.ignore):not(.click)";l.on(a.toolbarContainer,"click",t,function(t){t.preventDefault();var n=e.getStoredDataFromAllDiagrams(),o=1,a=n.diagrams;for(var l in a)a[l].id=a[l].id+"-"+o++;var i=this.getAttribute("href"),s=JSON.stringify(n);switch(i){case"json-file":var r=this.parentNode,c=window.btoa(unescape(encodeURIComponent(s))),u="data:text/octet-stream;base64,"+c;r.insertAdjacentHTML("beforeEnd",'<a id="temp-link" class="ignore click" href="'+u+'" download="flow.json"></a>');var d=r.querySelector("#temp-link");d.click(),r.removeChild(d);break;case"local-storage":window.localStorage.setItem("flow",s);break;default:var p="Save "+i+" option doesn't exist";throw e.Alerts.showErrorMessage(p),p}e.Alerts.showSuccessMessage("Successfully saved")})},o._tabCloseDiagramClick=function(){l.on(a.diagramContainer,"click",".flow.tab.close",function(){if(e.Alerts.confirm("You really want to delete this flowchart?")){var n=this.getAttribute("data-flow-target"),o=t.getElementById(n);null!==o&&e.closeDiagram(o),e.cleanStoredDiagramData(n),l.remove(this.parentNode)}})},o._tabOpenDiagramClick=function(){l.on(a.diagramContainer,"click","a.flow.tab.link",function(){var n=this.getAttribute("data-flow-target");if(null===t.getElementById(n)){var o=e.getCurrentDiagram();null!==o&&e.closeDiagram(o),e.recreateDiagramFromStoredData(n)}})},o._tabOpenDiagramDoubleClick=function(){l.on(a.diagramContainer,"dblclick","a.flow.tab.link",function(){var e=this.parentNode,n=this.textContent,o=this.cloneNode(),a=!1,l=null;e.removeChild(this),e.insertAdjacentHTML("beforeEnd",'<input id="flow-temp-change-name" type="text" value="'+n+'" />'),l=e.querySelector("#flow-temp-change-name"),l.focus(),l.addEventListener("keyup",function(e){a===!1&&13===e.keyCode&&(a=!0,t(l,o,n))}),l.addEventListener("blur",function(e){a===!1&&(a=!0,t(l,o,n))})});var t=function(t,n,o){var a=t.value,l=t.parentNode,i=null;if(l.removeChild(t),i=l.appendChild(n),a.length>3){if(i.textContent=a,l.classList.contains("active")){var s=e.getCurrentDiagram();s.setAttribute("data-flow-name",a),s.setAttribute("title",a)}}else i.textContent=o,e.Alerts.showWarningMessage("Diagram names must contain at least 4 characters");!function(){var e=l.querySelector("span");e.style.display="none",e.offsetHeight,e.style.display="block"}()}},o._consoleToggleButtonClick=function(){var e=null;a.consoleToggle.addEventListener("click",function(t){var n=a.consoleArea;window.clearInterval(e),n.style.height||(n.style.height=window.getComputedStyle(n).getPropertyValue("height")),e=n.classList.contains("hidden")?setInterval(function(){var t=parseInt(n.style.height,10);t>0?n.style.height=t-15+"px":window.clearInterval(e)},20):setInterval(function(){var t=parseInt(n.style.height,10);200>t?n.style.height=t+15+"px":window.clearInterval(e)},20),n.classList.toggle("hidden")})},o._activeFlowchartClick=function(){l.on(a.diagramContainer,"click",".diagram.active",function(t){e.UI.unmarkAllShapes(),t.target.classList.contains("diagram")&&e.Selection.unselectElements()})},o._activeFlowchartKeyUp=function(){l.on(a.diagramContainer,"keyup",".diagram.active",function(t){var n=this,o=t.target.nodeName.toLowerCase(),a=46===t.keyCode;a&&"input"!==o?(e.Selection.deleteSelectedItems(),n.focus()):90===t.keyCode&&t.ctrlKey&&t.shiftKey?e.State.redo():90===t.keyCode&&t.ctrlKey&&e.State.undo()})},o._shapeClick=function(){l.on(a.diagramContainer,"click",".diagram.active div.shape",function(e){})},o._shapeDoubleClicked=function(){l.on(a.diagramContainer,"dblclick",".active.diagram div.shape",function(t){"true"===this.getAttribute("data-flow-has-user-text")?e.UI.openShapeInput(this):e.Alerts.showErrorMessage("This shape cannnot contain user input")})},o._executionButtonsClick=function(){l.on(a.consoleExecute,"click",function(t){e.ExecutionHandler.triggertExecution(),e.UI.appendCodeToEditor();var n=code.join(" ");console.log(n),code=[],indent=0}),l.on(a.consoleDebugStart,"click",function(t){e.UI.enableDebugNextButton(),e.UI.enableDebugStopButton(),e.ExecutionHandler.triggerDebug()}),l.on(a.consoleDebugNext,"click",function(t){e.ExecutionHandler.executeNext()}),l.on(a.consoleDebugStop,"click",function(t){e.ExecutionHandler.stopDebug()})},o._refreshConsoleClick=function(){l.on(a.consoleExhibitionClean,"click",function(t){e.UI.cleanConsoleContent()})},o._shapeAltered=function(){var t=e.Const.SHAPE_EVENT.ALTERATED;l.on(a.diagramContainer,t,"div.shape",function(t){var n=t.target,o=t.payload;e.State.pushShapeAlteration(n,o),e.State.cleanRedoState()})},function(){n.bind("beforeDrop",function(o){var a=t.getElementById(o.sourceId),l=t.getElementById(o.targetId),i=l.getAttribute("data-flow-shape-type"),s=n.getConnections({source:l,target:a}),r=n.getConnections({source:a,target:l});return a===l?(e.Alerts.showWarningMessage("Recursive connections aren't allowed"),!1):s.length>0&&i!==e.Const.SHAPE_TYPE.DECISION?(e.Alerts.showWarningMessage("Elements already connected"),!1):r.length>0?(e.Alerts.showWarningMessage("Duplicate connections aren't allowed"),!1):(e.Util.trigger(e.Const.SHAPE_EVENT.ALTERATED,a),!0)})}(),function(){var t={gradient:{stops:[[0,"#D95C5C"],[1,"white"]]},strokeStyle:"#D95C5C"};n.bind("click",function(n){var o=e.Selection.getSelectedItem(),a=o&&"connection"===o.type&&o.from===n.sourceId&&o.to===n.targetId;a||(n.setPaintStyle(t),e.Selection.addSelectedConnection(n.sourceId,n.targetId))})}(),function(){n.bind("dblclick",function(t){var n=t.source.getAttribute("data-flow-connection-type");n===e.Const.CONNECTION_TYPE.BOOLEAN?e.UI.openBooleanConnection(t):e.UI.openTextConnection(t)})}(),e}(flow||{},document,jsPlumb),flow=function(e){"use strict";e.Templates={};var t=e.Templates;return t.getShapeInnerInput=function(e){return'<input type="text" value="'+e+'" />'},t.getShapeInnerCode=function(e){return"<code>"+e+"</code>"},t.getConnectionLabel=function(e){return'<span class="flow connection label">'+e+"</span>"},t.getNewDiagram=function(t,n){return void 0===n&&(n=e.Util.getUniqueID(t)),'<div id="'+n+'" class="flow active diagram" title="'+t+'" data-flow-name="'+t+'" tabindex="-1"><span class="hidden-anchor" tabindex="-1">Anchor</span></div>'},t.getTabItem=function(e,t){return'<li class="flow active tab item" data-flow-target="'+e+'"><a class="flow tab link" href="#" data-flow-target="'+e+'" title="Open this diagram">'+t+'</a><span class="flow tab close" data-flow-target="'+e+'" title="Close this diagram"> x</span></li>'},t.getPaginatedDiagramItem=function(e,t){return'<li class="flow pagination item"><a class="flow pagination link" href="#" data-flow-target="'+e+'" >'+t+"</a></li>"},t.getConnectionEmptyInput=function(t){return'<input id="'+t+'" type="text" class="connector-text"  maxlength="'+e.Const.MAX_INPUT_LENGTH+'" />'},t.getConnectionFilledInput=function(t,n,o,a){return"<input id='"+t+"' type='text' value='"+n+"' class='connection label overlay' style='top:"+o+"; left:"+a+";' maxlength='"+e.Const.MAX_INPUT_LENGTH+"' />"},t.getConnectionPlainText=function(e,t,n,o){return"<p id='"+e+"' class='connection label overlay' style='top:"+n+"; left:"+o+";' >"+t+"</p>"},t.getConnectionSelect=function(e,t,n){return"<select id='"+e+"' class='connection label overlay' style='top:"+t+"; left:"+n+";'><option value=''></option><option value='true'>true</option><option value='false'>false</option></select>"},t.getConnectionSelectWithTrueSelected=function(e,t,n){return"<select id='"+e+"' class='connection label overlay' style='top:"+t+"; left:"+n+";'><option value=''></option><option value='true' selected>true</option><option value='false'>false</option></select>"},t.getConnectionSelectWithFalseSelected=function(e,t,n){return"<select id='"+e+"' class='connection label overlay' style='top:"+t+"; left:"+n+";'><option value=''></option><option value='true'>true</option><option value='false' selected>false</option></select>"},e}(flow||{}),flow=function(e,t){"use strict";var n=e.Alerts;return e.ExecutionHandler={currentNode:null,nextNodeDOM:null,cachedNodes:{},generateCode:function(){var t={},n=function(a){var l=a.id,i=a.getAttribute("data-flow-shape-type");if(l in t){if(i===e.Const.SHAPE_TYPE.CONNECTOR){var s=jsPlumb.getConnections({source:a});indent-=1,n(s[0].target)}}else{t[l]=!0;var s=jsPlumb.getConnections({source:a}),r=jsPlumb.getConnections({target:a}),c=r.length>1?!0:!1;switch(c&&i!==e.Const.SHAPE_TYPE.DECISION&&i!==e.Const.SHAPE_TYPE.CONNECTOR,i){case e.Const.SHAPE_TYPE.BEGIN:n(s[0].target);break;case e.Const.SHAPE_TYPE.END:indent-=1;break;case e.Const.SHAPE_TYPE.CONNECTOR:break;case e.Const.SHAPE_TYPE.PROCESS:var u=o(a).replace("<-","=");code.push("\n");for(var d=0;indent>d;d++)code.push("	");code.push(u),n(s[0].target);break;case e.Const.SHAPE_TYPE.DISPLAY:var u="print "+o(a);code.push("\n");for(var d=0;indent>d;d++)code.push("	");code.push(u),n(s[0].target);break;case e.Const.SHAPE_TYPE.MANUAL_INPUT:var u=o(a).replace(/([a-zA-Z_$][0-9a-zA-Z_$]*)/,'$1 =int(raw_input("Insert the value of $1"))');code.push("\n");for(var d=0;indent>d;d++)code.push("	");code.push(u),n(s[0].target);break;case e.Const.SHAPE_TYPE.DECISION:var p=null,g=null;/true/i.test(s[0].getLabel())?(p=s[0].target,g=s[1].target):(p=s[1].target,g=s[0].target);var h=s[0].target.id,f=s[1].target.id;if(h in t||f in t){code.push("\n");for(var d=0;indent>d;d++)code.push("	");code.push("while "),code.push(o(a)),code.push(" :"),indent+=1,n(h in t?s[1].target:s[0].target)}else if(c){code.push("\n");for(var d=0;indent>d;d++)code.push("	");code.push("while "),code.push(o(a)),indent+=1,code.push(" :"),n(p),indent-=1,n(g)}else{code.push("\n");for(var d=0;indent>d;d++)code.push("	");code.push("if "),code.push(o(a)),code.push(" :"),indent+=1,n(p),code.push("\n");for(var d=0;indent>d;d++)code.push("	");code.push("else :"),indent+=1,n(g)}}}},o=function(e){return e.querySelector("code").textContent};n(this.getBeginShape());code.join(" ")},cleanAttributesValues:function(){e.Nodes.cleanVarTable(),this.cachedNodes={},this.currentNode=null,this.nextNodeDOM=null},triggertExecution:function(){this.cleanAttributesValues(),e.Selection.unselectElements(),e.UI.unmarkAllShapes();var t=this.getBeginShape();return null===t?(n.showErrorMessage("Element begin not found"),!1):(this.currentNode=e.Nodes.factory(t),this.nextNodeDOM=this.currentNode.execute(),this.executeAll(),void 0)},executeAll:function(){for(;null!==this.nextNodeDOM;)this.setCurrentNode(),this.nextNodeDOM=this.currentNode.execute();e.UI.markShapeAsExecuted(this.currentNode.selector),e.UI.enableExecutionButtons(),n.showSuccessMessage("Execution complete")},triggerDebug:function(){this.cleanAttributesValues(),e.UI.unmarkAllShapes();var t=this.getBeginShape();return null!==t?(n.showInfoMessage("Debug initiated"),this.currentNode=e.Nodes.factory(t),this.nextNodeDOM=this.currentNode.execute(),e.UI.markShapeAsExecuted(this.currentNode.selector),e.UI.disableExecuteButton(),!0):(n.showErrorMessage("Element begin not found"),!1)},executeNext:function(){e.UI.unmarkShapeAsExecuted(this.currentNode.selector),this.setCurrentNode(),this.nextNodeDOM=this.currentNode.execute(),e.UI.markShapeAsExecuted(this.currentNode.selector),null===this.nextNodeDOM&&(n.showSuccessMessage("Execution complete"),e.UI.disableDebugButtons(),e.UI.enableExecuteButton())},stopDebug:function(){n.showSuccessMessage("Debug canceled"),e.UI.disableDebugButtons(),e.UI.enableExecuteButton(),e.UI.unmarkAllShapes()},setCurrentNode:function(){if(null!==this.nextNodeDOM){var t=this.nextNodeDOM.id;this.cachedNodes.hasOwnProperty(t)?this.currentNode=this.cachedNodes[t]:(this.currentNode=e.Nodes.factory(this.nextNodeDOM),this.cachedNodes[t]=this.currentNode)}},getBeginShape:function(){return e.getCurrentDiagram().querySelector('div.shape[data-flow-shape-type="begin"]')},getDebugNextNode:function(){var e=this.currentNode.getNextNodeSelector$;if(null!==e)return e;throw n.showErrorMessage("End of the algorithm"),"End of the algorithm"}},e}(flow,document),flow=function(e,t){"use strict";return e.UI={appendContentToConsole:function(t){e.Cache.consoleExhibitionContent.insertAdjacentHTML("beforeEnd","<code>"+t+"</code><br>"),e.Cache.consoleExhibition.scrollTop=e.Cache.consoleExhibition.scrollHeight},appendCodeToEditor:function(t){e.ExecutionHandler.generateCode();var n=code.join(" ");console.log(n),code=[];var o=ace.edit("editor2");o.setValue(n),o.setTheme("ace/theme/tomorrow_night_blue"),o.session.setMode("ace/mode/python"),o.setAutoScrollEditorIntoView(!0),o.setOption("minLines",2),e.Cache.editor2.scrollTop=e.Cache.consoleExhibition.scrollHeight},cleanConsoleContent:function(){e.Cache.consoleExhibitionContent.textContent=""},enableExecutionButtons:function(){this.disableExecutionButtons(),this.enableExecuteButton(),this.enableDebugButton()},disableExecutionButtons:function(){this.disableExecuteButton(),this.disableDebugButton(),this.disableDebugNextButton(),this.disableDebugStopButton()},disableDebugButtons:function(){this.disableDebugNextButton(),this.disableDebugStopButton(),this.enableDebugButton()},enableDebugNextButton:function(){e.Cache.consoleDebugNext.removeAttribute("disabled")},disableDebugNextButton:function(){e.Cache.consoleDebugNext.setAttribute("disabled","disabled")},enableExecuteButton:function(){e.Cache.consoleExecute.removeAttribute("disabled")},disableExecuteButton:function(){e.Cache.consoleExecute.setAttribute("disabled","disabled")},enableDebugStopButton:function(){e.Cache.consoleDebugStop.removeAttribute("disabled")},disableDebugStopButton:function(){e.Cache.consoleDebugStop.setAttribute("disabled","disabled")},enableDebugButton:function(){e.Cache.consoleDebugStart.removeAttribute("disabled")},disableDebugButton:function(){e.Cache.consoleDebugStart.setAttribute("disabled","disabled")},openHelp:function(){e.Cache.$helpTab.addClass("active"),document.getElementById("help-content").style.display="block"},closeHelp:function(){e.Cache.$helpTab.removeClass("active"),document.getElementById("help-content").style.display="none"},openTextConnection:function(n){var o=this.getConnectionHtmlId(n),a=n.getLabel();if(null===a||""===a)n.setLabel(e.Templates.getConnectionEmptyInput(o));else{var l=t.getElementById(o),i=l.textContent;n.setLabel(e.Templates.getConnectionFilledInput(o,i,l.style.top,l.style.left))}this.blurOnConnectionInput(n,i)},blurOnConnectionInput:function(n){var o=this,a=t.getElementById(this.getConnectionHtmlId(n));a.select(),a.focus(),e.Util.on(a,"blur",function(){o.setNewValueOfConnection(n,this)})},openBooleanConnection:function(n){
    var o=this.getConnectionHtmlId(n),a=t.getElementById(o);null!==a&&/true/i.test(a.textContent)?n.setLabel(e.Templates.getConnectionSelectWithTrueSelected(o,a.style.top,a.style.left)):null!==a&&/false/i.test(a.textContent)?n.setLabel(e.Templates.getConnectionSelectWithFalseSelected(o,a.style.top,a.style.left)):null!==a?n.setLabel(e.Templates.getConnectionSelect(o)):n.setLabel(e.Templates.getConnectionSelect(o)),this.clickOrBlurOnConnectionSelect(n)},clickOrBlurOnConnectionSelect:function(n){var o=this,a=t.getElementById(this.getConnectionHtmlId(n));a.focus(),e.Util.on(a,"blur",function(){o.setNewValueOfConnection(n,this)})},getConnectionHtmlId:function(e){return e.sourceId+"_"+e.targetId},setNewValueOfConnection:function(t,n){var o=n.id,a=n.value;t.setLabel(e.Templates.getConnectionPlainText(o,a,n.style.top,n.style.left))},openShapeInput:function(t){var n=null,o=null,a=null;n=t.querySelector("code"),o=n.textContent.replace(/"/g,"&quot;"),n.outerHTML=e.Templates.getShapeInnerInput(o),a=t.querySelector("input"),a.focus(),a.select();var l=!1;e.Util.on(a,"blur",function(e){l||(l=!0,i.call(this,e))}),e.Util.on(a,"keyup",function(e){13!==e.keyCode||l||(l=!0,i.call(this,e))});var i=function(n){var a=this.value;a!==o&&e.Util.trigger(e.Const.SHAPE_EVENT.ALTERATED,t),this.outerHTML=e.Templates.getShapeInnerCode(a)}},markShapeAsSelected:function(e){e.classList.add("selected"),e.focus()},unmarkShapeAsSelected:function(e){e.classList.remove("selected")},unmarkAllShapes:function(){for(var t=e.getCurrentDiagram().querySelectorAll("div.shape.executed, div.shape.invalid"),n=t.length;n--;){var o=t[n];o.classList.remove("invalid"),o.classList.remove("executed")}},markShapeAsExecuted:function(e){e.classList.add("executed"),e.focus()},unmarkShapeAsExecuted:function(e){e.classList.remove("executed")},markShapeAsInvalid:function(e){e.classList.add("invalid"),e.focus()},unmarkShapeAsInvalid:function(e){e.classList.remove("invalid")},markFailure:function(t,n){throw void 0!==n&&this.markShapeAsInvalid(n),e.Alerts.showErrorMessage(t),this.enableExecutionButtons(),t}},e}(flow||{},document),flow=function(e){"use strict";e.Const={};var t=e.Const;return t.MAX_INPUT_LENGTH=30,t.SHAPE_TYPE={PROCESS:"process",DISPLAY:"display",DECISION:"decision",MANUAL_INPUT:"manual_input",CONNECTOR:"connector",BEGIN:"begin",END:"end"},t.DIAGRAM_EVENT={CREATED:"diagram_created",DELETED:"diagram_deleted",LOADED:"diagram_loaded"},t.SHAPE_EVENT={SELECTED:"shape_selected",MOVED:"shape_moved",DELETED:"shape_deleted",ALTERATED:"shape_altered",CREATED:"shape_created"},t.CONNECTION_EVENT={ALTERED:"connection_altered",SELECTED:"connection_selected"},t.CONNECTION_TYPE={BOOLEAN:"boolean",TEXT:"text"},e}(flow||{}),flow=function(e,t,n){"use strict";e.Selection={};var o=e.Selection,a=null;return o.addSelectedShape=function(t){this.unselectElements(),a={type:"shape",id:t.id},e.UI.markShapeAsSelected(t)},o.addSelectedConnection=function(e,t){this.unselectElements(),a={type:"connection",from:e,to:t}},o.deleteSelectedItems=function(){if(a){if("shape"===a.type){var o=t.getElementById(a.id);e.Util.trigger(e.Const.SHAPE_EVENT.ALTERATED,o),n.detachAllConnections(o),e.Util.remove(o)}else{var l=t.getElementById(a.from),i=n.getConnections({source:a.from,target:a.to})[0];e.Util.trigger(e.Const.SHAPE_EVENT.ALTERATED,l),n.detach(i)}a=null}},o.getSelectedItem=function(){return a},o.unselectShapes=function(){a&&"shape"===a.type&&(e.UI.unmarkShapeAsSelected(t.getElementById(a.id)),a=null)},o.unselectConnections=function(){if(a&&"connection"===a.type){var e=n.getConnections({source:a.from,target:a.to})[0];e.setPaintStyle(n.Defaults.PaintStyle),a=null}},o.unselectElements=function(){this.unselectShapes(),this.unselectConnections(),a=null,e.UI.unmarkAllShapes()},o.cleanSelection=function(){a=null},e}(flow||{},document,jsPlumb),flow=function(flow,jsPlumb){"use strict";flow.Nodes={varTable:{},factory:function(e){var t=e.getAttribute("data-flow-shape-type");switch(t){case flow.Const.SHAPE_TYPE.PROCESS:return new Process(e);case flow.Const.SHAPE_TYPE.DISPLAY:return new Display(e);case flow.Const.SHAPE_TYPE.MANUAL_INPUT:return new ManualInput(e);case flow.Const.SHAPE_TYPE.DECISION:return new Decision(e);default:return new Node(e)}},cleanVarTable:function(){this.varTable={}}};var Node=function(e){this.selector=e,this.execute=function(){return this.validate(),this.getNextNodeSelector()},this.getParsedContent=function(){},this.getNextNodeSelector=function(){var e=jsPlumb.getConnections({source:this.selector});return e.length>0?e[0].target:null},this.validate=function(){var e=jsPlumb.getConnections({source:this.selector});e.length<1&&"0"!==this.selector.getAttribute("data-flow-max-outputs")&&flow.UI.markFailure("Output flow not found",this.selector)}};Node.prototype={getContent:function(){return this.selector.querySelector("code").textContent}};var Process=function(selector){Node.call(this,selector),this.execute=function(){this.validate();try{eval(this.getParsedContent()),sweet=sweet.concat(this.getContent()),sweet=sweet.concat("\n"),console.log(this.getContent())}catch(e){flow.log(e),flow.UI.markFailure("Erro de sintaxe",this.selector)}return this.getNextNodeSelector()},this.getParsedContent=function(){for(var e=this.getContent().replace("<-","=").split(/("[^"]*")/),t=0,n=e.length;n>t;t++)/^"[^"]*"$/.test(e[t])?""===e[t]&&delete e[t]:e[t]=e[t].replace(/([a-zA-Z_$][0-9a-zA-Z_$]*)/g," flow.Nodes.varTable.$1 ");return e.join(" ")}};Process.prototype=Object.create(Node.prototype);var Display=function(selector){Node.call(this,selector),this.execute=function(){this.validate();var e=this.getParsedContent(),t="<span style='color: teal;'>"+getExpression(e)+" -> </span>",n=getEvaluatedValue(e);return console.log(this.getContent()),sweet=sweet.concat("print "),sweet=sweet.concat(this.getContent()),sweet=sweet.concat("\n"),flow.UI.appendContentToConsole(t+n),this.getNextNodeSelector()};var getExpression=function(e){return e.replace(/flow\.Nodes\.varTable\./g,"")},getEvaluatedValue=function(content){try{var result=eval(content)}catch(e){flow.log(e),flow.UI.markFailure("Syntax error",this.selector)}return!Array.isArray(result)&&(void 0===result||null===result||"string"!=typeof result&&isNaN(result))&&(result="Null"),result};this.getParsedContent=function(){for(var e=this.getContent().split(/("[^"]*")/),t=0,n=e.length;n>t;t++)/^"[^"]*"$/.test(e[t])?""===e[t]&&delete e[t]:e[t]=e[t].replace(/([a-zA-Z_$][0-9a-zA-Z_$]*)/g," flow.Nodes.varTable.$1 ");return e.join(" ")}};Display.prototype=Object.create(Node.prototype);var ManualInput=function(selector){Node.call(this,selector),this.execute=function(){this.validate();try{eval(this.getParsedContent());var varName=this.getContent();console.log(this.getContent()),sweet=sweet.concat(this.getContent()),sweet=sweet.concat("= raw_input()"),sweet=sweet.concat("\n"),flow.Util.isNumber(flow.Nodes.varTable[varName])&&(flow.Nodes.varTable[varName]=parseFloat(flow.Nodes.varTable[varName]))}catch(e){flow.log(e),flow.UI.markFailure("Syntax error",this.selector)}return this.getNextNodeSelector()},this.getParsedContent=function(){return this.getContent().replace(/([a-zA-Z_$][0-9a-zA-Z_$]*)/," flow.Nodes.varTable.$1 = prompt('Insert the value of $1');")}};ManualInput.prototype=Object.create(Node.prototype);var Decision=function(selector){Node.call(this,selector),this.execute=function(){this.validate();try{console.log(this.getContent()),sweet=sweet.concat("if "),sweet=sweet.concat(this.getContent()),sweet=sweet.concat(": "),sweet=sweet.concat("\n");var expressionIsTrue=eval(this.getParsedContent())}catch(e){flow.log(e),flow.UI.markFailure("Erro de sintaxe",this.selector)}return this.getNextNodeSelector(expressionIsTrue)},this.getParsedContent=function(){for(var e=this.getContent().split(/("[^"]*")/),t=0,n=e.length;n>t;t++)/^"[^"]*"$/.test(e[t])?""===e[t]&&delete e[t]:e[t]=e[t].replace(/([a-zA-Z_$][0-9a-zA-Z_$]*)/g," flow.Nodes.varTable.$1 ");return e.join(" ")},this.getNextNodeSelector=function(e){var t=jsPlumb.getConnections({source:this.selector});return e===!0?/true/i.test(t[0].getLabel())?t[0].target:t[1].target:e===!1?/true/i.test(t[0].getLabel())?t[1].target:t[0].target:void flow.UI.markFailure("Execution error",this.selector)},this.validate=function(){var e=jsPlumb.getConnections({source:this.selector});e.length<2&&flow.UI.markFailure("A decision shape needs two output flows",is.selector);for(var t=!1,n=!1,o=0;o<e.length;o++)/true/i.test(e[o].getLabel())?t=!0:/false/i.test(e[o].getLabel())&&(n=!0);t&&n||flow.UI.markFailure("It's necessary to have a <b>true</b> and a <b>false</b> output",this.selector)}};return Decision.prototype=Object.create(Node.prototype),flow}(flow||{},jsPlumb),flow=function(e,t,n){"use strict";var o=e.Cache,a=!0;e.log=function(){a&&(1===arguments.length?console.log(arguments[0]):2===arguments.length&&console.log(arguments[0],arguments[1]))},e.makeMenuShapesDraggable=function(){var e=o.shapeMenu.querySelectorAll("div.flow.shape");n.draggable(e,{scope:"dragFromMenu",clone:!0})},e.getCurrentDiagram=function(){var e;return function(){return(void 0===e||null===e||null===e.parentNode)&&(e=o.diagramContainer.querySelector("div.flow.active.diagram")),e}}(),e.findShapeById=function(t){return e.getCurrentDiagram().querySelector('div.shape[data-flow-shape-id="'+t+'"]')},e.getShapeCloneByType=function(t){return e.Cache.shapeMenu.querySelector('div.shape[data-flow-shape-type="'+t+'"]').cloneNode(!0)},e.createDiagram=function(t,a){var i=e.getCurrentDiagram();null!==i&&e.closeDiagram(i),o.diagramContainer.insertAdjacentHTML("beforeEnd",e.Templates.getNewDiagram(t,a));var s=e.getCurrentDiagram();return s.scrollTop=s.scrollHeight/3.5,s.scrollLeft=s.scrollWidth/3.5,n.setContainer(s),l(s),e.Listeners.setupDiagramEvents(s),e.UI.enableExecutionButtons(),e.Util.trigger(e.Const.DIAGRAM_EVENT.CREATED,s),s},e.closeDiagram=function(t){var o=e.getDiagramData(t);e.storeDiagramData(o),e.Util.trigger(e.Const.DIAGRAM_EVENT.DELETED,t),e.Util.remove(t),e.Selection.cleanSelection(),n.detachEveryConnection(),e.State.cleanState()},e.openLocallyStoredDiagrams=function(){var t=!1,n=window.localStorage.getItem("flow");return null!==n&&""!==n&&(t=e.openDiagrams(n)),t},e.openDiagrams=function(t){var n={},o={};try{n=JSON.parse(t),o=n.diagrams}catch(a){return e.Alerts.showErrorMessage("Error, invalid data."),e.log(a),!1}e.Util.count=n.data.count+1;for(var l in o){var i=o[l];e.storeDiagramData(i),e.recreateDiagramFromStoredData(i.id)}return!0},e.recreateDiagramFromStoredData=function(t){var n=e.getStoredDiagramData(t);e.cleanStoredDiagramData(t);var a=e.createDiagram(n.name,t),l=o.tabMenuList.querySelector('.flow.tab.item[data-flow-target="'+t+'"]');if(null===l)e.appendTabItemToDiagramArea(n.name);else{var i=o.tabMenuList.querySelector(".flow.tab.item.active");null!==i&&i.classList.remove("active"),l.classList.add("active")}this.createDiagramShapesFromArray(a,n.shapes)},e.createDiagramShapesFromArray=function(e,a){for(var l=t.createDocumentFragment(),i=a.length;i--;){var r=a[i],c=o.shapeMenu.querySelector('div[data-flow-shape-type="'+r.type+'"]'),u=c.cloneNode(!0),d=u.querySelector(".shape.image");l.appendChild(u),u.style.top=r.top,u.style.left=r.left,d.style.height=r.height,d.style.width=r.width,u.querySelector("code").textContent=r.code,u.setAttribute("data-flow-shape-id",r.id),s(u)}e.appendChild(l);var p=e.querySelector(".begin");p&&p.focus(),n.setSuspendDrawing(!0);for(var i=a.length;i--;){var r=a[i],g=e.querySelector('[data-flow-shape-id="'+r.id+'"]'),h=r.targetConnections;for(var f in h){var m=h[f],b=e.querySelector('[data-flow-shape-id="'+f+'"]');n.connect({source:g,target:b,label:m.label||""})}}n.setSuspendDrawing(!1,!0)},e.appendTabItemToDiagramArea=function(t){var n=o.tabMenuList.querySelector(".flow.tab.item.active");null!==n&&n.classList.remove("active"),o.tabMenuList.insertAdjacentHTML("beforeEnd",e.Templates.getTabItem(e.getCurrentDiagram().id,t))},e.closeAllDiagrams=function(){for(e.cleanAllDiagramsStoredData={};o.tabMenuList.hasChildNodes();)o.tabMenuList.removeChild(o.tabMenuList.lastChild);var t=e.getCurrentDiagram();null!==t&&e.closeDiagram(t)},e.makeShapeDraggable=function(t,o){t.removeAttribute("id"),n.draggable(t,{start:function(t){var n=t.el;e.Selection.addSelectedShape(n),e.Util.trigger(e.Const.SHAPE_EVENT.ALTERATED,n)},drag:function(e){return"TODO"}}),o.maxInputs>0?n.makeTarget(t,{maxConnections:o.maxInputs,isTarget:!0}):-1===o.maxOutputs&&n.makeTarget(t,{isTarget:!0}),o.maxOutputs>0?n.makeSource(t,{maxConnections:o.maxOutputs,filter:".connector",isSource:!0}):-1===o.maxOutputs&&n.makeSource(t,{filter:".connector",isSource:!0})};var l=function(t){var o=n._katavorio_main;o.droppable(t,{scope:"dragFromMenu",drop:function(n){var o=n.drop.el,a=n.drag.el,l=parseInt(a.getAttribute("data-flow-max-copies"),10),r=a.getAttribute("data-flow-shape-type");if(-1===l||i(t,r)<l){var c=a.cloneNode(!0);c.style.left=n.e.layerX+o.scrollLeft+"px",c.style.top=n.e.layerY+o.scrollTop+"px",t.appendChild(c),s(c),e.Util.trigger(e.Const.SHAPE_EVENT.ALTERATED,c,"created")}else e.Alerts.showWarningMessage("You cannot create more shapes of this type")}})},i=function(e,t){return e.querySelectorAll('div.shape[data-flow-shape-type="'+t+'"]').length},s=function(t){var n=r(t);e.makeShapeDraggable(t,n),n.secondId||t.setAttribute("data-flow-shape-id",e.Util.getUniqueID(n.type))},r=function(e){var t=e.querySelector("code");return{secondId:e.getAttribute("data-flow-shape-id"),type:e.getAttribute("data-flow-shape-type"),hasUserText:"true"===e.getAttribute("data-flow-has-user-text"),maxOutputs:parseInt(e.getAttribute("data-flow-max-outputs"),10),maxInputs:parseInt(e.getAttribute("data-flow-max-inputs"),10),maxCopies:parseInt(e.getAttribute("data-flow-max-copies"),10),value:null!==t?t.textContent:"",left:e.style.left,top:e.style.top}};return e}(flow||{},document,jsPlumb);jsPlumb.ready(function(){"use strict";flow.Cache.setCache(),flow.setDefaults(),flow.makeMenuShapesDraggable(),flow.Util.invokeAllFunctions(flow.StaticListeners);var e=flow.openLocallyStoredDiagrams();e&&flow.Alerts.showSuccessMessage("Diagrams found in the browser automatically open")});